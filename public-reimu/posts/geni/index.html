<!doctype html><html lang=en data-theme-mode=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Geni | Koyphshi</title><meta name=description content="Exploiting a CSI-FiSh variant by tracking torsion points through a sequence of leaked generator images."><script>window.siteConfig=JSON.parse('{"anchor_icon":null,"base":"https://lanaceryasser.github.io/","clipboard":{"copyright":{"count":50,"enable":false,"license_type":"by-nc-sa"},"fail":{"en":"Copy failed (ﾟ⊿ﾟ)ﾂ","ja":"コピー失敗 (ﾟ⊿ﾟ)ﾂ","pt-br":"Falha ao copiar (ﾟ⊿ﾟ)ﾂ","zh-cn":"复制失败 (ﾟ⊿ﾟ)ﾂ","zh-tw":"複製失敗 (ﾟ⊿ﾟ)ﾂ"},"success":{"en":"Copy successfully (*^▽^*)","ja":"コピー成功 (*^▽^*)","pt-br":"Copiado com sucesso (*^▽^*)","zh-cn":"复制成功 (*^▽^*)","zh-tw":"複製成功 (*^▽^*)"}},"code_block":{"expand":true},"icon_font":"4552607_4k4bc36ef96","outdate":{"daysago":180,"enable":false,"message":{"en":"This article was last updated on {time}. Please note that the content may no longer be applicable.","ja":"この記事は最終更新日：{time}。記載内容が現在有効でない可能性がありますのでご注意ください。","pt-br":"Este artigo foi atualizado pela última vez em {time}. Observe que o conteúdo pode não ser mais aplicável.","zh-cn":"本文最后更新于 {time}，请注意文中内容可能已不适用。","zh-tw":"本文最後更新於 {time}，請注意文中內容可能已不適用。"}}}')</script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7c&amp;display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7c&amp;display=swap" media=print onload='this.media="all"'><link rel=preload href=//at.alicdn.com/t/c/font_4552607_4k4bc36ef96.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=stylesheet href=/css/loader.min.ac746e154f756f8220326eeb52a719f142ab038be5a8ddf30ea5ef15ef2356ea.css><meta property="og:type" content="website"><meta property="og:title" content="Geni | Koyphshi"><meta property="og:description" content="Exploiting a CSI-FiSh variant by tracking torsion points through a sequence of leaked generator images."><meta property="og:url" content="https://lanaceryasser.github.io/posts/geni/"><meta property="og:site_name" content="Koyphshi (Dark Mode)"><meta property="og:image" content="/"><meta property="article:author" content="Koyphshi"><meta property="article:published_time" content="2025-12-22T00:00:00+00:00"><meta property="article:modified_time" content="2025-12-22T00:00:00+00:00"><meta property="article:tag" content="isogenycryptocsidhweil-pairing"><meta name=twitter:card content="summary"><meta name=twitter:image content="/"><link rel="shortcut icon" href=/favicon.ico><link rel=stylesheet href=/css/main.min.2ab445531328403f9d181790710209e87710b833ed837cad4a9432828b7ed82e.css><link rel=preload as=style href=https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css integrity=sha384-IfxC36XL/toUyJ939C73PcgMuRzAZuIzZxE38drsmO5p6jD7ei+Zx/1oA/0l8ysE crossorigin=anonymous onload='this.onload=null,this.rel="stylesheet"'><link rel=preload as=style href=https://npm.webcache.cn/katex@0.16.24/dist/katex.min.css integrity=sha384-tTgKLjMYmJr94v8qu2PE5MUGSMbyN2xiH266JUB3gpm8vnnJywd1dWSOEfrFz+YI crossorigin=anonymous onload='this.onload=null,this.rel="stylesheet"'><script src=https://npm.webcache.cn/pace-js@1.2.4/pace.min.js integrity=sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8 crossorigin=anonymous></script><link rel=stylesheet href=https://npm.webcache.cn/@reimujs/aos@0.1.2/dist/aos.css integrity=sha384-GMRP93c6Hkz9JVKGAuRR3nTS7M07RwPgTFenXiosjq2VbVgvdDNcz1g6Mkj8AONa crossorigin=anonymous></head><body><div id=loader><div class="loading-left-bg loading-bg"></div><div class="loading-right-bg loading-bg"></div><div class=spinner-box><div class="loading-taichi rotate"><svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" shape-rendering="geometricPrecision"><path d="M303.5 432a80 80 0 01-12 160 80 80 0 0112-160z" fill="var(--red-1, #ff5252)"/><path d="M512 65a447 447 0 010 894V929a417 417 0 000-834 417 417 0 000 834v30a447 447 0 010-894zm0 30A417 417 0 01929 512 208.5 208.5.0 01720.5 720.5V592a80 80 0 000-160 80 80 0 000 160V720.5A208.5 208.5.0 01512 512 208.5 208.5.0 00303.5 303.5 208.5 208.5.0 0095 512 417 417 0 01512 95z" fill="var(--red-1, #ff5252)"/></svg></div><div class=loading-word>Loading...</div></div></div></div><script>var time=null,loaderEl=document.getElementById("loader"),startLoading=()=>{time=Date.now(),loaderEl.classList.remove("loading")},hideLoader=()=>{document.body.style.overflow="auto",loader.classList.add("loading")},endLoading=()=>{time?Date.now()-time>500?(time=null,hideLoader()):(setTimeout(endLoading,500-(Date.now()-time)),time=null):hideLoader()};window.addEventListener("DOMContentLoaded",endLoading),loaderEl.addEventListener("click",endLoading)</script><div id=copy-tooltip></div><div id=lang-tooltip>This article does not have a corresponding language version</div><div id=heatmap-tooltip></div><div id=container><div id=wrap><div id=header-nav><nav id=main-nav aria-label="Primary navigation"><a class=main-nav-link-wrap href=/><div class='main-nav-icon icon rotate'>&#xe62b;</div><span class=main-nav-link>Home</span>
</a><a class=main-nav-link-wrap href=/archives><div class='main-nav-icon icon rotate'>&#xe62b;</div><span class=main-nav-link>Archives</span>
</a><a class=main-nav-link-wrap href=/friend><div class='main-nav-icon icon rotate'>&#xe62b;</div><span class=main-nav-link>Friend</span>
</a><a id=main-nav-toggle class=nav-icon aria-label="Toggle navigation" role=button></a></nav><nav id=sub-nav aria-label="Secondary navigation"></nav></div><header id=header aria-label="Site header"><picture></picture>
<img fetchpriority=high src=/images/default-cover.png alt=Geni><div id=header-outer><div id=header-title><span id=logo><h1 data-aos=slide-up>Geni</h1></span><h2 id=subtitle-wrap data-aos=slide-down></h2></div></div></header><div id=content aria-label="Page content" class=sidebar-right><aside id=sidebar aria-label=Sidebar><div class="sidebar-wrapper-container sticky"><div class=sidebar-wrapper><div class=sidebar-wrap data-aos=fade-up><div class=sidebar-toc-sidebar><h3 class=toc-title>Contents</h3><div class="sidebar-toc-wrapper toc-div-class"><nav id=TableOfContents><ul><li><a href=#file-analysis>File Analysis</a></li><li><a href=#detailed-vulnerability-analysis>Detailed Vulnerability Analysis</a><ul><li><a href=#1-torsion-point-leakage>1. Torsion Point Leakage</a></li><li><a href=#2-the-linear-sequence-leak>2. The Linear Sequence Leak</a></li></ul></li><li><a href=#behind-the-math>Behind the Math</a><ul><li><a href=#frobenius-eigenspaces-and-kernels>Frobenius Eigenspaces and Kernels</a></li><li><a href=#the-weil-pairing>The Weil Pairing</a></li></ul></li><li><a href=#exploitation-process>Exploitation Process</a><ul><li><a href=#step-1-reconstructing-the-curves>Step 1: Reconstructing the Curves</a></li><li><a href=#step-2-tracking-torsion-images>Step 2: Tracking Torsion Images</a></li><li><a href=#step-3-recovering-the-exponents>Step 3: Recovering the Exponents</a></li></ul></li><li><a href=#full-solver-script>Full Solver Script</a></li></ul></nav></div></div><div class="sidebar-common-sidebar hidden"><div class=sidebar-author><img data-src=/%20avatar/avatar.png data-sizes=auto alt=Koyphshi class=lazyload><div class=sidebar-author-name>Koyphshi</div><div class=sidebar-description>Koyphshi - My Personal Blog (Dark & Premium)</div></div><div class=sidebar-state><div class=sidebar-state-article><div>Posts</div><div class=sidebar-state-number>5</div></div><a class=sidebar-state-category href=/%20categories/ aria-label=sidebar-state-category-link><div>Categories</div><div class=sidebar-state-number>2</div></a></div><div class=sidebar-social><div class="icon-github sidebar-social-icon"><a href=https://github.com/LanacerYasser itemprop=url target=_blank aria-label=github rel="noopener nofollow noreferrer"></a></div><div class="icon-linkedin sidebar-social-icon"><a href=https://www.linkedin.com/in/yasser-lanacer-1903442a8/ itemprop=url target=_blank aria-label=linkedin rel="noopener nofollow noreferrer"></a></div></div><div class=sidebar-menu><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/ aria-label=Home></a><div class='sidebar-menu-icon icon rotate'>&#xe62b;</div><div class=sidebar-menu-link>Home</div></div><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/archives aria-label=Archives></a><div class='sidebar-menu-icon icon rotate'>&#xe62b;</div><div class=sidebar-menu-link>Archives</div></div><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/friend aria-label=Friend></a><div class='sidebar-menu-icon icon rotate'>&#xe62b;</div><div class=sidebar-menu-link>Friend</div></div></div></div><div class=sidebar-btn-wrapper style=position:static><div class="sidebar-toc-btn current"></div><div class=sidebar-common-btn></div></div></div></div><div class=sidebar-widget></div></div></aside><section id=main aria-label="Main content"><article class="h-entry article" itemscope itemtype=https://schema.org/BlogPosting><div class=article-inner data-aos=fade-up><div class=article-meta><div class=article-date><span class="article-date-link icon-calendar" data-aos=zoom-in><time datetime="2025-12-22 00:00:00 +0000 +0000" itemprop=datePublished>2025-12-22</time>
<time style=display:none id=post-update-time>2025-12-22</time></span></div></div><div class=hr-line></div><div class="e-content article-entry" itemprop=articleBody><p>Last weekend, I participated in <strong>BSides Algiers CTF</strong>, hosted by <strong>Shellmates</strong>, and I was able to win <strong>1st place</strong>! I managed to solve all the cryptography challenges. This writeup focuses on the one I found to be the most interesting and hardest: <strong>Geni</strong>.</p><p>At first, I didn&rsquo;t have a deep understanding of isogenies, but by reading the <a href=https://cryptohack.org/challenges/isogenies/>CryptoHack Isogeny Challenges</a>, I gained a basic understanding that allowed me to start reading the challenge files and understand the underlying mechanics.</p><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-info-circle fa-fw"></i>Challenge Info<i class="details-icon fa-solid fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content><ul><li><strong>CTF</strong>: BSides Algiers 2025</li><li><strong>Challenge</strong>: Geni</li><li><strong>Category</strong>: Crypto</li><li><strong>Description</strong>: what about an isogeny challenge?</li><li><strong>Author</strong>: scalio</li></ul></div></div></div><h2 id=file-analysis><a class=header-anchor href=#file-analysis></a>File Analysis</h2><p>The challenge provided several SageMath files that implemented the cryptosystem:</p><ol><li><strong><code>CSIDH.sage</code></strong>: Contains the core logic for the Commutative Supersingular Isogeny Diffie-Hellman (CSIDH) group action over 74 small primes.</li><li><strong><code>scheme.sage</code></strong>: The main logic for the signature scheme. It defines key generation, Fiat-Shamir signing, and verification. It defines the structure of the public key.</li><li><strong><code>HKZbasis.sage</code></strong>: Provides lattice reduction functions (LLL/BKZ) to find short vectors in the relation basis of the class group, ensuring secret keys are manageable.</li><li><strong><code>out.txt</code></strong>: The challenge output containing the <code>Points_list</code> (public keys), parameters, message signature, and the encrypted flag.</li></ol><hr><h2 id=detailed-vulnerability-analysis><a class=header-anchor href=#detailed-vulnerability-analysis></a>Detailed Vulnerability Analysis</h2><p>The vulnerability is a combination of <strong>Torsion Point Leakage</strong> and a <strong>Linear Secret Sequence</strong>.</p><h3 id=1-torsion-point-leakage><a class=header-anchor href=#1-torsion-point-leakage></a>1. Torsion Point Leakage</h3><p>In standard CSIDH, a public key is just the target curve $E$. However, <code>scheme.sage</code> discloses the images of the generators $Q_1$ and $Q_2$ of the base curve $E_0$ under the secret isogeny $\Phi$:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#34;Points_list&#34;</span>: [(P<span style=color:#f92672>.</span>xy() , PP<span style=color:#f92672>.</span>xy()) <span style=color:#66d9ef>for</span> _ , P , PP <span style=color:#f92672>in</span> self<span style=color:#f92672>.</span>PK]
</span></span></code></pre></div><p>This disclosure is fatal. In isogeny-based cryptography, knowing where a torsion basis $(Q_1, Q_2)$ maps allows an attacker to compute the image of <strong>any</strong> point $T$ in the torsion group $E_0[p+1]$. If $T = uQ_1 + vQ_2$, then $\Phi(T) = u\Phi(Q_1) + v\Phi(Q_2)$.</p><h3 id=2-the-linear-sequence-leak><a class=header-anchor href=#2-the-linear-sequence-leak></a>2. The Linear Sequence Leak</h3><p>The secret key is a list of 16 vectors (<code>SK</code>) where each vector is derived linearly:
$$ SK[j] = SK[j-1] + \text{quick} \quad \text{where} \quad \text{quick} = -\text{sign}(SK[1]) $$
This means that for every prime lane $\ell_i$, the exponent $v_i$ is slowly counting down toward zero across the 16 curves provided in the public key. This allows us to &ldquo;read&rdquo; the secret exponents by watching when the image of a torsion point stops being zero.</p><hr><h2 id=behind-the-math><a class=header-anchor href=#behind-the-math></a>Behind the Math</h2><h3 id=frobenius-eigenspaces-and-kernels><a class=header-anchor href=#frobenius-eigenspaces-and-kernels></a>Frobenius Eigenspaces and Kernels</h3><p>In CSIDH, the group action by a prime ideal $\mathfrak{l}_i$ corresponds to an isogeny whose kernel is a subgroup of the $\ell_i$-torsion $E_0[\ell_i]$. On a supersingular curve over $\mathbb{F}_p$, the $\ell_i$-torsion splits into two eigenspaces under the Frobenius endomorphism $\pi$:</p><ol><li><strong>Positive Eigenspace ($T^+$):</strong> Points where $\pi(T) = T$.</li><li><strong>Negative Eigenspace ($T^-$):</strong> Points where $\pi(T) = -T$.</li></ol><p>If the secret exponent $v_i$ is positive, the isogeny $\Phi$ &ldquo;swallows&rdquo; the positive eigenspace. This means $\Phi(T^+) = 0$ (the point at infinity) on the target curve. If $v_i$ is negative, it swallows $T^-$.</p><h3 id=the-weil-pairing><a class=header-anchor href=#the-weil-pairing></a>The Weil Pairing</h3><p>To track these points, we must express $T^+$ and $T^-$ as linear combinations of the generators $Q_1, Q_2$. Since we are working with the full $(p+1)$-torsion, we use the <strong>Weil Pairing</strong> $e(\cdot, \cdot)$ to solve the discrete logarithm problem on the torsion group:
$$ u \equiv \log_{e(Q_1, Q_2)}(e(T, Q_2)) \pmod{\ell_i} $$
$$ v \equiv \log_{e(Q_1, Q_2)}(e(Q_1, T)) \pmod{\ell_i} $$</p><hr><h2 id=exploitation-process><a class=header-anchor href=#exploitation-process></a>Exploitation Process</h2><h3 id=step-1-reconstructing-the-curves><a class=header-anchor href=#step-1-reconstructing-the-curves></a>Step 1: Reconstructing the Curves</h3><p>We reconstruct the coefficients of the 16 target curves from the coordinates in <code>Points_list</code> by solving the curve equation $y^2 = x^3 + Ax + B$ for $A$ and $B$.</p><h3 id=step-2-tracking-torsion-images><a class=header-anchor href=#step-2-tracking-torsion-images></a>Step 2: Tracking Torsion Images</h3><p>We compute the coefficients $(u, v)$ for the $+1$ and $-1$ torsion points for each prime. We then evaluate their images across the 16 curves to check if they map to the point at infinity:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_uv</span>(T):
</span></span><span style=display:flex><span>    u <span style=color:#f92672>=</span> T<span style=color:#f92672>.</span>weil_pairing(Q2, p<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>.</span>log(pairing_base)
</span></span><span style=display:flex><span>    v <span style=color:#f92672>=</span> Q1<span style=color:#f92672>.</span>weil_pairing(T, p<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>.</span>log(pairing_base)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> u, v
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>img1_p <span style=color:#f92672>=</span> up <span style=color:#f92672>*</span> P_imgs[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> vp <span style=color:#f92672>*</span> PP_imgs[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>img1_m <span style=color:#f92672>=</span> um <span style=color:#f92672>*</span> P_imgs[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> vm <span style=color:#f92672>*</span> PP_imgs[<span style=color:#ae81ff>1</span>]
</span></span></code></pre></div><h3 id=step-3-recovering-the-exponents><a class=header-anchor href=#step-3-recovering-the-exponents></a>Step 3: Recovering the Exponents</h3><p>Because the 16 curves count down the exponent to zero, we check how many curves in the sequence map the torsion point to Zero. If it stops being zero at curve $j+1$, the exponent was exactly $j$.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>if</span> img1_p<span style=color:#f92672>.</span>is_zero():
</span></span><span style=display:flex><span>    count <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>16</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (up <span style=color:#f92672>*</span> P_imgs[j] <span style=color:#f92672>+</span> vp <span style=color:#f92672>*</span> PP_imgs[j])<span style=color:#f92672>.</span>is_zero():
</span></span><span style=display:flex><span>            count <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    v_found <span style=color:#f92672>=</span> count
</span></span></code></pre></div><p>By repeating this for all 74 primes, we perfectly reconstruct the secret vector $SK[1]$, derive the full $SK$ list, and hash it to obtain the AES key.</p><hr><h2 id=full-solver-script><a class=header-anchor href=#full-solver-script></a>Full Solver Script</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> hashlib
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Cipher <span style=color:#f92672>import</span> AES
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> Crypto.Util.Padding <span style=color:#f92672>import</span> unpad
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>primes <span style=color:#f92672>=</span> [<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>11</span>, <span style=color:#ae81ff>13</span>, <span style=color:#ae81ff>17</span>, <span style=color:#ae81ff>19</span>, <span style=color:#ae81ff>23</span>, <span style=color:#ae81ff>29</span>, <span style=color:#ae81ff>31</span>, <span style=color:#ae81ff>37</span>, <span style=color:#ae81ff>41</span>, <span style=color:#ae81ff>43</span>, <span style=color:#ae81ff>47</span>, <span style=color:#ae81ff>53</span>, <span style=color:#ae81ff>59</span>, <span style=color:#ae81ff>61</span>, <span style=color:#ae81ff>67</span>, <span style=color:#ae81ff>71</span>, 
</span></span><span style=display:flex><span>          <span style=color:#ae81ff>73</span>, <span style=color:#ae81ff>79</span>, <span style=color:#ae81ff>83</span>, <span style=color:#ae81ff>89</span>, <span style=color:#ae81ff>97</span>, <span style=color:#ae81ff>101</span>, <span style=color:#ae81ff>103</span>, <span style=color:#ae81ff>107</span>, <span style=color:#ae81ff>109</span>, <span style=color:#ae81ff>113</span>, <span style=color:#ae81ff>127</span>, <span style=color:#ae81ff>131</span>, <span style=color:#ae81ff>137</span>, <span style=color:#ae81ff>139</span>, <span style=color:#ae81ff>149</span>, <span style=color:#ae81ff>151</span>, 
</span></span><span style=display:flex><span>          <span style=color:#ae81ff>157</span>, <span style=color:#ae81ff>163</span>, <span style=color:#ae81ff>167</span>, <span style=color:#ae81ff>173</span>, <span style=color:#ae81ff>179</span>, <span style=color:#ae81ff>181</span>, <span style=color:#ae81ff>191</span>, <span style=color:#ae81ff>193</span>, <span style=color:#ae81ff>197</span>, <span style=color:#ae81ff>199</span>, <span style=color:#ae81ff>211</span>, <span style=color:#ae81ff>223</span>, <span style=color:#ae81ff>227</span>, <span style=color:#ae81ff>229</span>, <span style=color:#ae81ff>233</span>, 
</span></span><span style=display:flex><span>          <span style=color:#ae81ff>239</span>, <span style=color:#ae81ff>241</span>, <span style=color:#ae81ff>251</span>, <span style=color:#ae81ff>257</span>, <span style=color:#ae81ff>263</span>, <span style=color:#ae81ff>269</span>, <span style=color:#ae81ff>271</span>, <span style=color:#ae81ff>277</span>, <span style=color:#ae81ff>281</span>, <span style=color:#ae81ff>283</span>, <span style=color:#ae81ff>293</span>, <span style=color:#ae81ff>307</span>, <span style=color:#ae81ff>311</span>, <span style=color:#ae81ff>313</span>, <span style=color:#ae81ff>317</span>, 
</span></span><span style=display:flex><span>          <span style=color:#ae81ff>331</span>, <span style=color:#ae81ff>337</span>, <span style=color:#ae81ff>347</span>, <span style=color:#ae81ff>349</span>, <span style=color:#ae81ff>353</span>, <span style=color:#ae81ff>359</span>, <span style=color:#ae81ff>367</span>, <span style=color:#ae81ff>373</span>, <span style=color:#ae81ff>587</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>p <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> prod(primes) <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>Fp <span style=color:#f92672>=</span> GF(p)
</span></span><span style=display:flex><span>F<span style=color:#f92672>.&lt;</span>i<span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> GF(p<span style=color:#f92672>^</span><span style=color:#ae81ff>2</span>, modulus<span style=color:#f92672>=</span>x<span style=color:#f92672>^</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>E0 <span style=color:#f92672>=</span> EllipticCurve(F, [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>parse_out</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;out.txt&#34;</span>, <span style=color:#e6db74>&#34;r&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        data <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    sections <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    current <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> data<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;:&#39;</span> <span style=color:#f92672>in</span> line <span style=color:#f92672>and</span> <span style=color:#f92672>not</span> line<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#39; &#39;</span>):
</span></span><span style=display:flex><span>            current <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;:&#39;</span>)[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>            sections[current] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> current:
</span></span><span style=display:flex><span>            sections[current] <span style=color:#f92672>+=</span> line
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>    pts_list <span style=color:#f92672>=</span> sage_eval(sections[<span style=color:#e6db74>&#39;Points_list&#39;</span>], locals<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;i&#39;</span>: i})
</span></span><span style=display:flex><span>    hex_res <span style=color:#f92672>=</span> sections[<span style=color:#e6db74>&#39;Hex result&#39;</span>]<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> pts_list, hex_res
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pts_list, hex_res <span style=color:#f92672>=</span> parse_out()
</span></span><span style=display:flex><span>Q1_coords, Q2_coords <span style=color:#f92672>=</span> pts_list[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>Q1 <span style=color:#f92672>=</span> E0(Q1_coords)
</span></span><span style=display:flex><span>Q2 <span style=color:#f92672>=</span> E0(Q2_coords)
</span></span><span style=display:flex><span>pairing_base <span style=color:#f92672>=</span> Q1<span style=color:#f92672>.</span>weil_pairing(Q2, p <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>E_list <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>P_imgs <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>PP_imgs <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>16</span>):
</span></span><span style=display:flex><span>    (x1, y1), (x2, y2) <span style=color:#f92672>=</span> pts_list[j]
</span></span><span style=display:flex><span>    x1, y1, x2, y2 <span style=color:#f92672>=</span> F(x1), F(y1), F(x2), F(y2)
</span></span><span style=display:flex><span>    A <span style=color:#f92672>=</span> ((y1<span style=color:#f92672>^</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> x1<span style=color:#f92672>^</span><span style=color:#ae81ff>3</span>) <span style=color:#f92672>-</span> (y2<span style=color:#f92672>^</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> x2<span style=color:#f92672>^</span><span style=color:#ae81ff>3</span>)) <span style=color:#f92672>/</span> (x1 <span style=color:#f92672>-</span> x2)
</span></span><span style=display:flex><span>    B <span style=color:#f92672>=</span> y1<span style=color:#f92672>^</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> x1<span style=color:#f92672>^</span><span style=color:#ae81ff>3</span> <span style=color:#f92672>-</span> A<span style=color:#f92672>*</span>x1
</span></span><span style=display:flex><span>    Ej <span style=color:#f92672>=</span> EllipticCurve(F, [A, B])
</span></span><span style=display:flex><span>    E_list<span style=color:#f92672>.</span>append(Ej)
</span></span><span style=display:flex><span>    P_imgs<span style=color:#f92672>.</span>append(Ej(x1, y1))
</span></span><span style=display:flex><span>    PP_imgs<span style=color:#f92672>.</span>append(Ej(x2, y2))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sk1 <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;[*] Recovering exponents via Zero-Image analysis...&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> idx, l <span style=color:#f92672>in</span> enumerate(primes):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        xr <span style=color:#f92672>=</span> Fp<span style=color:#f92672>.</span>random_element()
</span></span><span style=display:flex><span>        rhs <span style=color:#f92672>=</span> xr<span style=color:#f92672>^</span><span style=color:#ae81ff>3</span> <span style=color:#f92672>+</span> xr
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> is_square(rhs):
</span></span><span style=display:flex><span>            Tp <span style=color:#f92672>=</span> ((p<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>//</span>l) <span style=color:#f92672>*</span> E0(xr, sqrt(rhs))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> Tp<span style=color:#f92672>.</span>is_zero(): <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        xr <span style=color:#f92672>=</span> Fp<span style=color:#f92672>.</span>random_element()
</span></span><span style=display:flex><span>        rhs <span style=color:#f92672>=</span> xr<span style=color:#f92672>^</span><span style=color:#ae81ff>3</span> <span style=color:#f92672>+</span> xr
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> is_square(rhs):
</span></span><span style=display:flex><span>            Tm <span style=color:#f92672>=</span> ((p<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>//</span>l) <span style=color:#f92672>*</span> E0(xr, i <span style=color:#f92672>*</span> sqrt(<span style=color:#f92672>-</span>rhs))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> Tm<span style=color:#f92672>.</span>is_zero(): <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_uv</span>(T):
</span></span><span style=display:flex><span>        u <span style=color:#f92672>=</span> T<span style=color:#f92672>.</span>weil_pairing(Q2, p<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>.</span>log(pairing_base)
</span></span><span style=display:flex><span>        v <span style=color:#f92672>=</span> Q1<span style=color:#f92672>.</span>weil_pairing(T, p<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>.</span>log(pairing_base)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> u, v
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    up, vp <span style=color:#f92672>=</span> get_uv(Tp)
</span></span><span style=display:flex><span>    um, vm <span style=color:#f92672>=</span> get_uv(Tm)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    v_found <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    img1_p <span style=color:#f92672>=</span> up <span style=color:#f92672>*</span> P_imgs[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> vp <span style=color:#f92672>*</span> PP_imgs[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    img1_m <span style=color:#f92672>=</span> um <span style=color:#f92672>*</span> P_imgs[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> vm <span style=color:#f92672>*</span> PP_imgs[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> img1_p<span style=color:#f92672>.</span>is_zero():
</span></span><span style=display:flex><span>        count <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>16</span>):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (up <span style=color:#f92672>*</span> P_imgs[j] <span style=color:#f92672>+</span> vp <span style=color:#f92672>*</span> PP_imgs[j])<span style=color:#f92672>.</span>is_zero(): count <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>: <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        v_found <span style=color:#f92672>=</span> count
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>elif</span> img1_m<span style=color:#f92672>.</span>is_zero():
</span></span><span style=display:flex><span>        count <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> j <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>16</span>):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (um <span style=color:#f92672>*</span> P_imgs[j] <span style=color:#f92672>+</span> vm <span style=color:#f92672>*</span> PP_imgs[j])<span style=color:#f92672>.</span>is_zero(): count <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>: <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        v_found <span style=color:#f92672>=</span> <span style=color:#f92672>-</span>count
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    sk1<span style=color:#f92672>.</span>append(int(v_found))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SK <span style=color:#f92672>=</span> [[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>*</span><span style=color:#ae81ff>74</span>]
</span></span><span style=display:flex><span>SK<span style=color:#f92672>.</span>append(sk1)
</span></span><span style=display:flex><span>quick <span style=color:#f92672>=</span> [int(<span style=color:#f92672>-</span>sign(x)) <span style=color:#66d9ef>for</span> x <span style=color:#f92672>in</span> sk1]
</span></span><span style=display:flex><span>curr <span style=color:#f92672>=</span> list(sk1)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>14</span>):
</span></span><span style=display:flex><span>    curr <span style=color:#f92672>=</span> [int(curr[k] <span style=color:#f92672>+</span> quick[k]) <span style=color:#66d9ef>for</span> k <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>74</span>)]
</span></span><span style=display:flex><span>    SK<span style=color:#f92672>.</span>append(curr)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>key_str <span style=color:#f92672>=</span> str(SK)
</span></span><span style=display:flex><span>aes_key <span style=color:#f92672>=</span> hashlib<span style=color:#f92672>.</span>sha256(key_str<span style=color:#f92672>.</span>encode())<span style=color:#f92672>.</span>digest()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>res <span style=color:#f92672>=</span> bytes<span style=color:#f92672>.</span>fromhex(hex_res)
</span></span><span style=display:flex><span>iv, ct <span style=color:#f92672>=</span> res[:<span style=color:#ae81ff>16</span>], res[<span style=color:#ae81ff>16</span>:]
</span></span><span style=display:flex><span>cipher <span style=color:#f92672>=</span> AES<span style=color:#f92672>.</span>new(aes_key, AES<span style=color:#f92672>.</span>MODE_CBC, iv)
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> unpad(cipher<span style=color:#f92672>.</span>decrypt(ct), <span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>[+] Success! Flag: </span><span style=color:#e6db74>{</span>flag<span style=color:#f92672>.</span>decode()<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p><strong>Flag:</strong> <code>shellmates{Weil_Pairing_and_Frobenius_u_get_torsion_group_Kernel_Sign}</code></p></div><footer class=article-footer><ul class=article-category-list><li class=article-tag-list-item data-aos=zoom-in><a class=article-category-link href=/categories/ctf data-aos=zoom-in>ctf</a></li></ul></footer></div><nav id=article-nav aria-label="Article navigation" data-aos=fade-up><div class="article-nav-link-wrap left"><img data-src=https://d-sketon.top/img/_backwebp/bg1.webp data-sizes=auto alt="Vrai Sahll" class=lazyload><a href=/posts/ingeneer/ aria-label="Prev:Vrai Sahll" title="Prev:Vrai Sahll"></a><div class=article-nav-caption>Prev</div><h3 class=article-nav-title>Vrai Sahll</h3></div><div class="article-nav-link-wrap right"><img data-src=https://d-sketon.top/img/_backwebp/bg1.webp data-sizes=auto alt="Only-invited party" class=lazyload><a href=/posts/indit/ aria-label="Next:Only-invited party" title="Next:Only-invited party"></a><div class=article-nav-caption>Next</div><h3 class=article-nav-title>Only-invited party</h3></div></nav></article></section></div><footer id=footer aria-label="Site footer"><div style=width:100%;overflow:hidden><div class=footer-line></div></div><div id=footer-info><div><span class=icon-copyright></span>2020-2026<span class="footer-info-sep rotate"></span>Koyphshi</div><div>Powered by&nbsp;<a href=https://gohugo.io/ target=_blank rel="noopener nofollow noreferrer">Hugo</a>&nbsp;Theme.<a href=https://github.com/D-Sketon/hugo-theme-reimu target=_blank rel="noopener nofollow noreferrer">Reimu</a></div><div><span class=icon-brush>&nbsp;9.0k</span>
&nbsp;|&nbsp;
<span class=icon-coffee>&nbsp;00:46</span></div><div><span class=icon-eye></span>
<span id=busuanzi_container_site_pv>Number of visits&nbsp;<span id=busuanzi_value_site_pv></span></span>
&nbsp;|&nbsp;
<span class=icon-user></span>
<span id=busuanzi_container_site_uv>Number of visitors&nbsp;<span id=busuanzi_value_site_uv></span></span></div></div></footer><div class=sidebar-top><div class="sidebar-top-taichi rotate"></div><div class=arrow-up></div></div><div id=mask class=hide></div></div><nav id=mobile-nav aria-label="Mobile navigation"><div class=sidebar-wrap><div class=sidebar-toc-sidebar><h3 class=toc-title>Contents</h3><div class="sidebar-toc-wrapper toc-div-class"><nav id=TableOfContents><ul><li><a href=#file-analysis>File Analysis</a></li><li><a href=#detailed-vulnerability-analysis>Detailed Vulnerability Analysis</a><ul><li><a href=#1-torsion-point-leakage>1. Torsion Point Leakage</a></li><li><a href=#2-the-linear-sequence-leak>2. The Linear Sequence Leak</a></li></ul></li><li><a href=#behind-the-math>Behind the Math</a><ul><li><a href=#frobenius-eigenspaces-and-kernels>Frobenius Eigenspaces and Kernels</a></li><li><a href=#the-weil-pairing>The Weil Pairing</a></li></ul></li><li><a href=#exploitation-process>Exploitation Process</a><ul><li><a href=#step-1-reconstructing-the-curves>Step 1: Reconstructing the Curves</a></li><li><a href=#step-2-tracking-torsion-images>Step 2: Tracking Torsion Images</a></li><li><a href=#step-3-recovering-the-exponents>Step 3: Recovering the Exponents</a></li></ul></li><li><a href=#full-solver-script>Full Solver Script</a></li></ul></nav></div></div><div class="sidebar-common-sidebar hidden"><div class=sidebar-author><img data-src=/%20avatar/avatar.png data-sizes=auto alt=Koyphshi class=lazyload><div class=sidebar-author-name>Koyphshi</div><div class=sidebar-description>Koyphshi - My Personal Blog (Dark & Premium)</div></div><div class=sidebar-state><div class=sidebar-state-article><div>Posts</div><div class=sidebar-state-number>5</div></div><a class=sidebar-state-category href=/%20categories/ aria-label=sidebar-state-category-link><div>Categories</div><div class=sidebar-state-number>2</div></a></div><div class=sidebar-social><div class="icon-github sidebar-social-icon"><a href=https://github.com/LanacerYasser itemprop=url target=_blank aria-label=github rel="noopener nofollow noreferrer"></a></div><div class="icon-linkedin sidebar-social-icon"><a href=https://www.linkedin.com/in/yasser-lanacer-1903442a8/ itemprop=url target=_blank aria-label=linkedin rel="noopener nofollow noreferrer"></a></div></div><div class=sidebar-menu><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/ aria-label=Home></a><div class='sidebar-menu-icon icon rotate'>&#xe62b;</div><div class=sidebar-menu-link>Home</div></div><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/archives aria-label=Archives></a><div class='sidebar-menu-icon icon rotate'>&#xe62b;</div><div class=sidebar-menu-link>Archives</div></div><div class=sidebar-menu-link-wrap><a class=sidebar-menu-link-dummy href=/friend aria-label=Friend></a><div class='sidebar-menu-icon icon rotate'>&#xe62b;</div><div class=sidebar-menu-link>Friend</div></div></div></div></div><div class=sidebar-btn-wrapper><div class="sidebar-toc-btn current"></div><div class=sidebar-common-btn></div></div></nav></div><script src=https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js integrity=sha384-3gT/vsepWkfz/ff7PpWNUeMzeWoH3cDhm/A8jM7ouoAK0/fP/9bcHHR5kHq2nf+e crossorigin=anonymous></script><script src=https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js integrity=sha384-J08i8An/QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q crossorigin=anonymous></script><script src=/js/main.js integrity crossorigin=anonymous></script><script src=/js/aos.js integrity crossorigin=anonymous></script><script>var aosInit=()=>{AOS.init({duration:1e3,easing:"ease",once:!0,offset:50})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",aosInit):aosInit()</script><script src=/js/pjax_main.js integrity crossorigin=anonymous data-pjax></script><script>var setupFirework=()=>{if((!!1||!window.matchMedia("(max-width: 768px)").matches)&&window.firework){const e=JSON.parse('{"excludeelements":["a","button"],"particles":[{"colors":["var(--red-1)","var(--red-2)","var(--red-3)","var(--red-4)"],"duration":[1200,1800],"easing":"easeOutExpo","move":["emit"],"number":20,"shape":"circle","shapeOptions":{"alpha":[0.3,0.5],"radius":[16,32]}},{"colors":["var(--red-0)"],"duration":[1200,1800],"easing":"easeOutExpo","move":["diffuse"],"number":1,"shape":"circle","shapeOptions":{"alpha":[0.2,0.5],"lineWidth":6,"radius":20}}]}');e.excludeElements=e.excludeelements,delete e.excludeelements,window.firework(e)}}</script><script src=https://npm.webcache.cn/mouse-firework@0.2.0/dist/index.umd.js defer onload=setupFirework() integrity=sha384-qi9WggRt19tv8Vc7pCHW3ulMNLwrn515zaLEWZjl1px07vz8+pUoWX8n1rgq282T crossorigin=anonymous></script><div id=lazy-script><div><script data-pjax>window.REIMU_POST={author:"Koyphshi",title:"Geni",url:"https://lanaceryasser.github.io/posts/geni/",description:"Exploiting a CSI-FiSh variant by tracking torsion points through a sequence of leaked generator images.",cover:"https://lanaceryasser.github.io/images/banner.png"}</script><script src=/js/insert_highlight.js integrity crossorigin=anonymous data-pjax></script><script src=/js/tabs.js integrity crossorigin=anonymous data-pjax defer></script><script type=module data-pjax>const PhotoSwipeLightbox = (await safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe-lightbox.esm.min.js", "sha384-DiL6M\/gG\u002bwmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF\/N6lrZi\/")).default;const initPswp = (gallery, children) => {
          if (_$$(`${gallery} ${children}`).length > 0) {
            new PhotoSwipeLightbox({
              gallery,
              children,pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")}).init();
          }
        }
        const pswp = () => {
          initPswp('.article-entry', 'a.article-gallery-item');
          initPswp('.article-gallery', 'a.article-gallery-item');
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script><script src=https://npm.webcache.cn/katex@0.16.24/dist/katex.min.js data-pjax integrity=sha384-MWNUH0WmtsYGhn2cbH6ELRCbf9LG3QDqCC+gqPB3IBNO35xjZK3Ejb6oONRpDbPg crossorigin=anonymous></script><script src=https://npm.webcache.cn/katex@0.16.24/dist/contrib/auto-render.min.js data-pjax integrity=sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh crossorigin=anonymous></script><script data-pjax>var renderMath=()=>{if(!window.renderMathInElement)return;window.renderMathInElement(_$("article"),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",renderMath,{once:!0}):renderMath()</script></div></div><script src=https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js async integrity=sha384-0M75wtSkhjIInv4coYlaJU83+OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id+S crossorigin=anonymous></script><script>"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(e=>{for(let t of e)t.unregister()})</script><script>const reimuCopyright=String.raw`
   ______     ______     __     __    __     __  __    
  /\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
  \ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
   \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
    \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                    
  `;console.log(String.raw`%c ${reimuCopyright}`,"color: #ff5252;"),console.log("%c Theme.Reimu %c https://github.com/D-Sketon/hugo-theme-reimu ","color: white; background: #ff5252; padding:5px 0;","padding:4px;border:1px solid #ff5252;")</script></body></html>